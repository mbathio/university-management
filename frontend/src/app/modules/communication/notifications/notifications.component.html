<!-- src/app/modules/communication/notifications/notifications.component.html -->
<div class="notifications-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Notifications</mat-card-title>
      <div class="header-actions">
        <button
          mat-button
          color="primary"
          (click)="markAllAsRead()"
          [disabled]="isMarkAllAsReadDisabled()"
        >
          <mat-icon>done_all</mat-icon>
          Tout marquer comme lu
        </button>
      </div>
    </mat-card-header>

    <mat-card-content>
      <!-- Loader -->
      <div *ngIf="loading" class="loading-container">
        <mat-spinner diameter="40"></mat-spinner>
      </div>

      <!-- Error message -->
      <div *ngIf="error" class="error-message">
        <mat-icon color="warn">error</mat-icon>
        <p>{{ error }}</p>
      </div>

      <!-- No notifications message -->
      <div
        *ngIf="!loading && !error && notifications.length === 0"
        class="empty-state"
      >
        <mat-icon>notifications_off</mat-icon>
        <p>Aucune notification</p>
      </div>

      <!-- Notifications list -->
      <mat-list *ngIf="!loading && !error && notifications.length > 0">
        <mat-list-item
          *ngFor="let notification of notifications"
          [ngClass]="{
            'notification-read': notification.read,
            'notification-unread': !notification.read,
          }"
          [routerLink]="getNotificationRoute(notification)"
          (click)="markAsRead(notification.id)"
        >
          <div matListItemIcon>
            <mat-icon
              [matBadge]="notification.read ? '' : ''"
              matBadgeColor="accent"
              matBadgeSize="small"
              [matBadgeHidden]="notification.read"
            >
              {{ getNotificationIcon(notification.type) }}
            </mat-icon>
          </div>

          <div matListItemTitle>{{ notification.title }}</div>
          <div matListItemLine>{{ notification.message }}</div>
          <div matListItemMeta>
            {{ notification.createdAt | date: "dd/MM/yyyy HH:mm" }}
          </div>

          <div matListItemMeta>
            <button
              mat-icon-button
              (click)="
                $event.stopPropagation(); deleteNotification(notification.id)
              "
            >
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>
</div>
