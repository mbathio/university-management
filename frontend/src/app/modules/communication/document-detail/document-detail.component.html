<!-- src/app/modules/communication/document-detail/document-detail.component.html -->
<div class="document-detail-container">
  <!-- Loading spinner -->
  <div *ngIf="loading" class="loading-spinner-container">
    <mat-spinner diameter="40"></mat-spinner>
  </div>

  <!-- Error message -->
  <div *ngIf="error" class="error-message">
    <mat-icon color="warn">error</mat-icon>
    <p>{{ error }}</p>
    <button mat-raised-button color="primary" (click)="goBack()">
      Retour à la liste
    </button>
  </div>

  <!-- Document details -->
  <div *ngIf="!loading && !error && document">
    <mat-card class="document-card">
      <mat-card-header>
        <div mat-card-avatar class="document-header-image">
          <mat-icon [ngClass]="'doc-icon-' + document.type.toLowerCase()"
            >description</mat-icon
          >
        </div>
        <mat-card-title>{{ document.title }}</mat-card-title>
        <mat-card-subtitle>
          {{ getDocumentTypeLabel(document.type) }} |
          <span class="document-date"
            >Créé le {{ document.createdAt | date: "dd/MM/yyyy" }}</span
          >
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="document-metadata">
          <div class="metadata-item">
            <span class="metadata-label">Auteur:</span>
            <span class="metadata-value">{{
              document.createdBy.fullName || "Non spécifié"
            }}</span>
          </div>
          <div class="metadata-item">
            <span class="metadata-label">Niveau de visibilité:</span>
            <span
              class="metadata-value visibility-badge {{
                document.visibilityLevel.toLowerCase()
              }}"
            >
              {{ document.visibilityLevel }}
            </span>
          </div>
          <div class="metadata-item" *ngIf="document.updatedAt">
            <span class="metadata-label">Dernière modification:</span>
            <span class="metadata-value">{{
              document.updatedAt | date: "dd/MM/yyyy HH:mm"
            }}</span>
          </div>
        </div>

        <mat-divider class="content-divider"></mat-divider>

        <div class="document-content">
          <p>{{ document.content }}</p>
        </div>

        <div
          *ngIf="document.tags && document.tags.length > 0"
          class="document-tags"
        >
          <h3>Tags:</h3>
          <mat-chip-set>
            <mat-chip *ngFor="let tag of document.tags">{{ tag }}</mat-chip>
          </mat-chip-set>
        </div>

        <div *ngIf="document.filePath" class="document-file">
          <h3>Fichier joint:</h3>
          <button mat-button color="primary" (click)="downloadDocument()">
            <mat-icon>file_download</mat-icon>
            Télécharger le fichier
          </button>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button mat-button (click)="goBack()">
          <mat-icon>arrow_back</mat-icon>
          Retour
        </button>
        <button
          mat-button
          color="primary"
          *ngIf="canEdit()"
          (click)="editDocument()"
        >
          <mat-icon>edit</mat-icon>
          Modifier
        </button>
        <button
          mat-button
          color="warn"
          *ngIf="canDelete()"
          (click)="deleteDocument()"
        >
          <mat-icon>delete</mat-icon>
          Supprimer
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
